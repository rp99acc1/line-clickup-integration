try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="fb56799e-95ae-4070-88d9-b3e339397e7e",e._sentryDebugIdIdentifier="sentry-dbid-fb56799e-95ae-4070-88d9-b3e339397e7e")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6443],{31775:(e,t,a)=>{a.d(t,{v:()=>p});var i=a(54568),n=a(45054),l=a(23812),s=a(3075),r=a(20683),d=a(7620),o=a(10369),u=a(59666),c=a(48579),m=a(43314);function p(e){let{onComplete:t,onSkip:a,isEnabled:p=!1,initialAmount:x=1500,initialThreshold:g=500,isSetupFlow:v=!1}=e,f=(0,o.A)(),{data:y}=(0,m.Wm)(),{addSuccess:h,addError:_}=(0,n.Y)(),{data:b}=(0,m.WF)(),{data:j}=(0,c.Pz)({}),{mutate:w,isPending:A}=(0,m.Wo)({onSuccess:()=>{k(null),"turnOn"===L?(h(f.formatMessage({defaultMessage:"Auto-reload has been enabled",id:"JTSyIVn+xw"})),t({threshold:M,amount:z})):"turnOff"===L?(h(f.formatMessage({defaultMessage:"Auto-reload has been disabled",id:"Fvcg75HZwF"})),t()):"update"===L&&(h(f.formatMessage({defaultMessage:"Auto-reload settings have been updated",id:"ZD2vLszx9z"})),t({threshold:M,amount:z}))},onError:e=>{_(e.message||f.formatMessage({defaultMessage:"Failed to update auto-reload settings",id:"papt78GhlH"}),{error:e}),k(null)}}),S=(null==b?void 0:b.currency)||(null==j?void 0:j.currency)||"USD",[M,N]=(0,d.useState)(g||500),[z,C]=(0,d.useState)(x||1500),[L,k]=(0,d.useState)(null),[P,E]=(0,d.useState)(!1),Q=e=>(0,r.vv)(e,S,{preferWholeNumber:!0}),T=e=>{let t=parseFloat(e.replace(/[^0-9.]/g,""));return isNaN(t)?0:Math.round(100*t)};return(0,i.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,i.jsx)("p",{className:"text-text-100",children:(0,i.jsx)(u.A,{defaultMessage:"Automatically replenish your balance when credits run low.",id:"zR8jc75ICB"})}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-text-100 mb-2",children:(0,i.jsx)(u.A,{defaultMessage:"Reload when balance reaches or goes below:",id:"OFMAXwHnxa"})}),(0,i.jsx)("input",{type:"text",value:Q(M),onChange:e=>{N(T(e.target.value))},className:"w-full px-3 py-2 bg-bg-000 border border-border-300 rounded-lg text-text-100 focus:outline-none focus:ring-2 focus:ring-bg-500 focus:border-text-000",placeholder:Q(500),disabled:A})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-text-100 mb-2",children:(0,i.jsx)(u.A,{defaultMessage:"Reload balance to:",id:"Al+ozKL44U"})}),(0,i.jsx)("input",{type:"text",value:Q(z),onChange:e=>{C(T(e.target.value))},className:"w-full px-3 py-2 bg-bg-000 border border-border-300 rounded-lg text-text-100 focus:outline-none focus:ring-2 focus:ring-bg-500 focus:border-text-000",placeholder:Q(1500),disabled:A})]})]}),M<500&&(0,i.jsx)("div",{className:"text-danger-000 text-sm -mt-3",children:(0,i.jsx)(u.A,{defaultMessage:"Threshold must be at least $5.00",id:"61QfyVk7ff"})}),z<1500&&(0,i.jsx)("div",{className:"text-danger-000 text-sm -mt-3",children:(0,i.jsx)(u.A,{defaultMessage:"Reload amount must be at least $15.00",id:"IW1wlSA2xZ"})}),z<M+1e3&&z>=1500&&M>=500&&(0,i.jsx)("div",{className:"text-danger-000 text-sm -mt-3",children:(0,i.jsx)(u.A,{defaultMessage:"Reload amount must be at least {minDifference} more than the threshold",id:"YByHQETXDu",values:{minDifference:(0,r.vv)(1e3,S,{preferWholeNumber:!0})}})}),(0,i.jsx)("p",{className:"text-text-500 text-sm",children:(0,i.jsx)(u.A,{defaultMessage:"You agree that Anthropic will charge the credit card you have on file in the amount above on a recurring basis whenever your wallet balance reaches the amount indicated. To cancel, turn off auto-reload.",id:"Y8/POu4E8K"})}),(0,i.jsxs)("div",{className:"flex justify-end gap-3",children:[!p&&(0,i.jsx)(l.$,{variant:"secondary",onClick:()=>{a()},disabled:A,children:v?(0,i.jsx)(u.A,{defaultMessage:"Skip",id:"/4tOwTiCH6"}):(0,i.jsx)(u.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),v||!p?(0,i.jsx)(l.$,{variant:"primary",onClick:()=>{v?t({threshold:M,amount:z}):(k("turnOn"),w({enabled:!0,threshold_in_minor_units:M,reload_to_in_minor_units:z}))},disabled:z<M+1e3||z<1500||M<500||A&&"turnOn"!==L,loading:A&&"turnOn"===L,children:(0,i.jsx)(u.A,{defaultMessage:"Turn on",id:"npvxprjeDK"})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.$,{variant:"secondary",onClick:()=>{E(!0)},disabled:A,loading:A&&"turnOff"===L,children:(0,i.jsx)(u.A,{defaultMessage:"Turn off",id:"XZ+Fx6Wrzh"})}),(0,i.jsx)(l.$,{variant:"primary",onClick:()=>{k("update"),w({enabled:!0,threshold_in_minor_units:M,reload_to_in_minor_units:z})},disabled:z<M+1e3||z<1500||M<500||A&&"update"!==L,loading:A&&"update"===L,children:(0,i.jsx)(u.A,{defaultMessage:"Set",id:"HnxG15XDc+"})})]})]}),(0,i.jsx)(s.aF,{isOpen:P,onClose:()=>E(!1),modalSize:"md",hasCloseButton:!0,title:(0,i.jsx)(u.A,{defaultMessage:"Turn off auto-reload",id:"u+o+OjWtIV"}),children:(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)("p",{className:"text-text-100 mb-6",children:(0,i.jsx)(u.A,{defaultMessage:"Your account will no longer be replenished automatically.",id:"MZ/OZ0bjN2"})}),(0,i.jsxs)(s.vW,{children:[(0,i.jsx)(s.yl,{variant:"secondary",onClick:()=>E(!1),disabled:A&&"turnOff"===L,children:(0,i.jsx)(u.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,i.jsx)(s.yl,{variant:"primary",onClick:()=>{k("turnOff"),E(!1),w({enabled:!1})},loading:A&&"turnOff"===L,children:(0,i.jsx)(u.A,{defaultMessage:"Turn off",id:"XZ+Fx6Wrzh"})})]})]})})]})}},36541:(e,t,a)=>{a.d(t,{l:()=>o});var i=a(54568),n=a(3075),l=a(7620),s=a(59666),r=a(63836),d=a(52816);function o(e){let{isOpen:t,onClose:a,hasAutoReload:o=!1}=e,[u,c]=(0,l.useState)(!1);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.aF,{isOpen:t&&!u,onClose:a,modalSize:"lg",hasCloseButton:!0,title:(0,i.jsx)(s.A,{defaultMessage:"Add funds",id:"sx0aSlxLIy"}),children:(0,i.jsx)("div",{className:"mt-6",children:(0,i.jsx)(r.G,{onComplete:a,hasAutoReload:o,onAutoReloadEnabled:()=>{c(!0)}})})}),(0,i.jsx)(d.M,{isOpen:u,onClose:()=>{c(!1),a()},currentEnabled:!1})]})}},43314:(e,t,a)=>{a.d(t,{$Q:()=>N,As:()=>g,D5:()=>h,HP:()=>M,I_:()=>x,OC:()=>z,RV:()=>y,St:()=>_,WF:()=>b,Wm:()=>m,Wo:()=>j,X0:()=>f,cy:()=>C,pA:()=>p,s6:()=>S,sj:()=>w,v:()=>A,zY:()=>v});var i=a(1613),n=a(64328),l=a(77223),s=a(19723),r=a(16178),d=a(80688),o=a(28),u=a(4869),c=a(48579);let m=e=>{var t;let{activeOrganization:a}=(0,n.YL)(),l=(0,s.b)(o.Nt.BillingView),r=(0,i.Sk)("/api/organizations/".concat(null==a?void 0:a.uuid,"/overage_spend_limit"),{queryKey:[d.wU,null==a?void 0:a.uuid],enabled:!!(null==a?void 0:a.uuid)&&l&&(null==(t=null==e?void 0:e.enabled)||t)}),u=r.data?{isEnabled:r.data.is_enabled,monthlyLimit:r.data.monthly_credit_limit,usedCredits:r.data.used_credits||0,organizationUuid:r.data.organization_uuid}:void 0;return{...r,data:u}},p=e=>{let{activeOrganization:t}=(0,n.YL)(),a=(0,u.useQueryClient)();return(0,i.L2)("/api/organizations/".concat(null==t?void 0:t.uuid,"/overage_spend_limit"),"PUT",{transformVariables:e=>({monthly_credit_limit:null==e?void 0:e.monthlyLimit,is_enabled:e.isEnabled}),onSuccess:i=>{var n;a.setQueryData([d.wU,null==t?void 0:t.uuid],i),a.invalidateQueries({queryKey:[d.wU]}),a.invalidateQueries({queryKey:[d.Rw]}),null==e||null==(n=e.onSuccess)||n.call(e,i)},onError:null==e?void 0:e.onError})},x=e=>{let{activeOrganization:t}=(0,n.YL)(),a=(0,u.useQueryClient)();return(0,i.L2)("/api/organizations/".concat(null==t?void 0:t.uuid,"/overage_spend_limit"),"PUT",{transformVariables:e=>({monthly_credit_limit:e.monthlyLimit,is_enabled:!0}),onSuccess:i=>{var n;a.setQueryData([d.wU,null==t?void 0:t.uuid],i),a.invalidateQueries({queryKey:[d.wU]}),a.invalidateQueries({queryKey:[d.Rw]}),null==e||null==(n=e.onSuccess)||n.call(e,i)},onError:null==e?void 0:e.onError})},g=e=>{let{activeOrganization:t}=(0,n.YL)(),a=(0,u.useQueryClient)();return(0,i.L2)("/api/organizations/".concat(null==t?void 0:t.uuid,"/overage_spend_limit"),"PUT",{transformVariables:()=>({is_enabled:!1}),onSuccess:i=>{var n;a.setQueryData([d.wU,null==t?void 0:t.uuid],i),a.invalidateQueries({queryKey:[d.wU]}),a.invalidateQueries({queryKey:[d.QG]}),a.invalidateQueries({queryKey:[d.cz]}),a.invalidateQueries({queryKey:[d.Rw]}),null==e||null==(n=e.onSuccess)||n.call(e,i)},onError:null==e?void 0:e.onError})},v=()=>{var e,t,a,l,r,u;let{activeOrganization:c}=(0,n.YL)(),m=(0,n.zm)(),p=(0,s.b)(o.Nt.BillingView),x=(0,i.Sk)("/api/organizations/".concat(null==c?void 0:c.uuid,"/overage_spend_limit?seat_tier=").concat(m?"enterprise_standard":"team_standard"),{queryKey:[d.QG,null==c?void 0:c.uuid,"standard"],enabled:!!(null==c?void 0:c.uuid)&&p}),g=(0,i.Sk)("/api/organizations/".concat(null==c?void 0:c.uuid,"/overage_spend_limit?seat_tier=").concat(m?"enterprise_tier_1":"team_tier_1"),{queryKey:[d.QG,null==c?void 0:c.uuid,"premium"],enabled:!!(null==c?void 0:c.uuid)&&p}),v=(0,i.Sk)("/api/organizations/".concat(null==c?void 0:c.uuid,"/overage_spend_limit?seat_tier=").concat("enterprise_usage_based"),{queryKey:[d.QG,null==c?void 0:c.uuid,"usage_based"],enabled:!!(null==c?void 0:c.uuid)&&m&&p});return{standard:null!=(l=null==(e=x.data)?void 0:e.monthly_credit_limit)?l:null,premium:null!=(r=null==(t=g.data)?void 0:t.monthly_credit_limit)?r:null,usageBased:null!=(u=null==(a=v.data)?void 0:a.monthly_credit_limit)?u:null,isLoading:x.isLoading||g.isLoading||v.isLoading}},f=e=>{var t;let{activeOrganization:a}=(0,n.YL)(),l=(0,s.b)(o.Nt.BillingView),r=new URLSearchParams;r.append("page",String((null==e?void 0:e.page)||1)),r.append("per_page",String((null==e?void 0:e.perPage)||100)),(null==e?void 0:e.sortBy)&&r.append("sort_by",e.sortBy),(null==e?void 0:e.sortOrder)&&r.append("sort_order",e.sortOrder),(null==e?void 0:e.filterSeatTier)&&r.append("filter_seat_tier",e.filterSeatTier),(null==e?void 0:e.isMemberLimit)!==void 0&&r.append("is_member_limit",String(e.isMemberLimit)),(null==e?void 0:e.search)&&r.append("search",e.search);let u=(0,i.Sk)("/api/organizations/".concat(null==a?void 0:a.uuid,"/overage_spend_limits?").concat(r.toString()),{queryKey:[d.cz,null==a?void 0:a.uuid,(null==e?void 0:e.page)||1,(null==e?void 0:e.perPage)||1,null==e?void 0:e.sortBy,null==e?void 0:e.sortOrder,null==e?void 0:e.filterSeatTier,null==e?void 0:e.isMemberLimit,null==e?void 0:e.search],enabled:!!(null==a?void 0:a.uuid)&&l}),c=null==(t=u.data)?void 0:t.items.map(e=>({userId:e.account_uuid||"",memberName:e.account_name||"",email:e.account_email||"",seatType:"unassigned"===e.seat_tier?"unassigned":"enterprise_standard"===e.seat_tier||"team_standard"===e.seat_tier?"standard":"premium",overageLimit:e.monthly_credit_limit,used:e.used_credits||0,percentUsed:null===e.monthly_credit_limit?0:Math.round((e.used_credits||0)/e.monthly_credit_limit*100),status:"ok",limitType:e.limit_type}));return{...u,data:c,pagination:u.data?{total:u.data.total,page:u.data.page,pageSize:u.data.page_size,totalPages:u.data.total_pages}:void 0}},y=e=>{let t=(e=>{let{activeOrganization:t}=(0,n.YL)(),a=(0,u.useQueryClient)();return(0,i.L2)("/api/organizations/".concat(null==t?void 0:t.uuid,"/overage_spend_limit"),"POST",{transformVariables:e=>({account_uuid:e.userId,monthly_credit_limit:e.limit}),onSuccess:(t,i)=>{var n;a.setQueriesData({queryKey:[d.cz]},e=>(null==e?void 0:e.items)?{...e,items:e.items.map(e=>e.account_uuid===i.userId?{...e,monthly_credit_limit:i.limit}:e)}:e),a.invalidateQueries({queryKey:[d.cz]}),a.invalidateQueries({queryKey:[d.Rw]}),null==e||null==(n=e.onSuccess)||n.call(e,t)},onError:null==e?void 0:e.onError})})(e),a=(e=>{let{activeOrganization:t}=(0,n.YL)(),a=(0,u.useQueryClient)();return(0,i.L2)("/api/organizations/".concat(null==t?void 0:t.uuid,"/overage_spend_limit"),"PUT",{transformVariables:e=>({account_uuid:e.userId,monthly_credit_limit:e.limit}),onSuccess:(t,i)=>{var n;a.setQueriesData({queryKey:[d.cz]},e=>(null==e?void 0:e.items)?{...e,items:e.items.map(e=>e.account_uuid===i.userId?{...e,monthly_credit_limit:i.limit}:e)}:e),a.invalidateQueries({queryKey:[d.cz]}),a.invalidateQueries({queryKey:[d.Rw]}),null==e||null==(n=e.onSuccess)||n.call(e,t)},onError:null==e?void 0:e.onError})})(e);return{mutate:(e,i)=>{e.isUpdate?a.mutate({userId:e.userId,limit:e.limit},i):t.mutate({userId:e.userId,limit:e.limit},i)},mutateAsync:async e=>e.isUpdate?a.mutateAsync({userId:e.userId,limit:e.limit}):t.mutateAsync({userId:e.userId,limit:e.limit}),isPending:t.isPending||a.isPending}},h=e=>{let{activeOrganization:t}=(0,n.YL)(),a=(0,n.zm)(),l=(0,u.useQueryClient)();return(0,i.L2)("/api/organizations/".concat(null==t?void 0:t.uuid,"/overage_spend_limit"),"PUT",{transformVariables:e=>({monthly_credit_limit:e.limit,seat_tier:"standard"===e.tier?a?"enterprise_standard":"team_standard":"premium"===e.tier?a?"enterprise_tier_1":"team_tier_1":"enterprise_usage_based"}),onSuccess:(a,i)=>{var n;let s="standard"===i.tier?"standard":"premium"===i.tier?"premium":"usage_based";l.setQueryData([d.QG,null==t?void 0:t.uuid,s],a),l.invalidateQueries({queryKey:[d.cz]}),l.invalidateQueries({queryKey:[d.QG]}),l.invalidateQueries({queryKey:[d.Rw]}),null==e||null==(n=e.onSuccess)||n.call(e,a)},onError:null==e?void 0:e.onError})},_=e=>{let{activeOrganization:t}=(0,n.YL)(),a=(0,u.useQueryClient)();return(0,i.L2)(e=>"/api/organizations/".concat(null==t?void 0:t.uuid,"/overage_spend_limit?account_uuid=").concat(e.accountUuid),"DELETE",{onSuccess:()=>{var t;a.invalidateQueries({queryKey:[d.cz]}),a.invalidateQueries({queryKey:[d.Rw]}),null==e||null==(t=e.onSuccess)||t.call(e)},onError:null==e?void 0:e.onError})},b=e=>{var t;let{activeOrganization:a}=(0,n.YL)(),l=(0,n.zm)(),u=(0,s.b)(o.Nt.BillingView);return(0,i.Sk)("/api/organizations/".concat(null==a?void 0:a.uuid,"/prepaid/credits"),{queryKey:[d.GA,null==a?void 0:a.uuid],enabled:!!(null==a?void 0:a.uuid)&&!l&&u&&(null==(t=null==e?void 0:e.enabled)||t),meta:{noToast:e=>e instanceof r.LG&&404===e.statusCode}})},j=e=>{let{activeOrganization:t}=(0,n.YL)(),a=(0,u.useQueryClient)();return(0,i.L2)("/api/organizations/".concat(null==t?void 0:t.uuid,"/contracts/auto_reload_settings"),"PUT",{onSuccess:i=>{var n;a.invalidateQueries({queryKey:[d.GA,null==t?void 0:t.uuid]}),a.invalidateQueries({queryKey:[d.p8,null==t?void 0:t.uuid]}),null==e||null==(n=e.onSuccess)||n.call(e,i)},onError:null==e?void 0:e.onError})},w=e=>{let{activeOrganization:t}=(0,n.YL)();return(0,i.Sk)("/api/organizations/".concat(null==t?void 0:t.uuid,"/prepaid/commits/").concat(e),{queryKey:[d.yH,null==t?void 0:t.uuid,e],enabled:!!(null==t?void 0:t.uuid)&&!!e,refetchInterval:e=>{let t=e.state.data;return(null==t?void 0:t.status)!=="paid"&&(null==t?void 0:t.status)!=="failed"&&2e3}})},A=e=>{let{activeOrganization:t}=(0,n.YL)(),a=(0,u.useQueryClient)();return(0,i.L2)("/api/organizations/".concat(null==t?void 0:t.uuid,"/contracts/prepaid/credits"),"POST",{onSuccess:i=>{var n;a.invalidateQueries({queryKey:[d.GA,null==t?void 0:t.uuid]}),null==e||null==(n=e.onSuccess)||n.call(e,i)},onError:null==e?void 0:e.onError})},S=e=>{let t=(0,l.ib)();return(0,i.L2)("","POST",{mutationFn:async e=>{let{clientSecret:a}=e,i=await t;if(!i)throw Error("Stripe failed to initialize. You can try again.");let n=await i.confirmPayment({clientSecret:a,confirmParams:{return_url:window.location.href},redirect:"if_required"});if(n.error)throw Error(n.error.message||"Payment confirmation failed")},onSuccess:()=>{var t;null==e||null==(t=e.onSuccess)||t.call(e)},onError:null==e?void 0:e.onError})},M=e=>{let{activeOrganization:t}=(0,n.YL)(),a=(0,u.useQueryClient)();return(0,i.L2)("/api/organizations/".concat(null==t?void 0:t.uuid,"/setup_overage_billing"),"POST",{onSuccess:i=>{var n;a.invalidateQueries({queryKey:[d.GA,null==t?void 0:t.uuid]}),a.invalidateQueries({queryKey:[d.wU,null==t?void 0:t.uuid]}),null==e||null==(n=e.onSuccess)||n.call(e,i)},onError:null==e?void 0:e.onError})},N=()=>{let e=(0,u.useQueryClient)();return{mutate:(t,a)=>{setTimeout(()=>{var t;null==a||null==(t=a.onSuccess)||t.call(a),e.invalidateQueries({queryKey:[d.GA]})},500)},isPending:!1}},z=()=>{let{data:e,isLoading:t}=(0,c.jN)(),a=[];if(null==e?void 0:e.payment_method){var i;let t=e.payment_method;a.push({type:(null==(i=t.brand)?void 0:i.toLowerCase())||"visa",last4:t.last4||"****",isDefault:!0})}return{data:a,isLoading:t,error:null,refetch:()=>Promise.resolve({data:a})}},C=e=>{var t;let{activeOrganization:a}=(0,n.YL)();return(0,i.Sk)("/api/organizations/".concat(null==a?void 0:a.uuid,"/usage"),{queryKey:[d.c6,null==a?void 0:a.uuid],enabled:!!(null==a?void 0:a.uuid)&&(null==(t=null==e?void 0:e.enabled)||t)})}},48801:(e,t,a)=>{a.d(t,{J:()=>o});var i=a(54568),n=a(64328),l=a(3075),s=a(48579),r=a(28122),d=a(97415);let o=e=>{let{isOpen:t,onClose:a,onPaymentMethodUpdated:o}=e,{activeOrganization:u}=(0,n.YL)(),{mutate:c}=(0,s.ZA)();return(0,i.jsx)(l.aF,{isOpen:t,onClose:a,modalSize:"md",children:(0,i.jsx)(d.n,{action:"update",product:"claude-ai",billingInterval:r.NW.MONTHLY,returnPath:"/settings/billing/".concat(null==u?void 0:u.uuid),onPaymentMethodUpdated:()=>{c(),o&&o(),setTimeout(()=>{a()},1e3)},onCancel:a})})}},52816:(e,t,a)=>{a.d(t,{M:()=>r});var i=a(54568),n=a(3075),l=a(59666),s=a(31775);function r(e){let{isOpen:t,onClose:a,onSave:r,currentEnabled:d=!1,currentAmount:o,currentThreshold:u}=e;return(0,i.jsx)(n.aF,{isOpen:t,onClose:a,modalSize:"lg",hasCloseButton:!0,title:d?(0,i.jsx)(l.A,{defaultMessage:"Adjust auto-reload",id:"lmMQUEPXAt"}):(0,i.jsx)(l.A,{defaultMessage:"Turn on auto-reload",id:"KPzQz15Q9f"}),children:(0,i.jsx)("div",{className:"mt-6",children:(0,i.jsx)(s.v,{onComplete:e=>{e&&r&&r(e),a()},onSkip:a,isEnabled:d,initialAmount:o,initialThreshold:u})})})}},59951:(e,t,a)=>{a.d(t,{o:()=>o});var i=a(64328),n=a(66365),l=a(7620),s=a(24407);let r=s.z.object({allowed_rate_tiers:s.z.union([s.z.string(),s.z.array(s.z.string())]).optional(),allowed_seat_tiers:s.z.union([s.z.string(),s.z.array(s.z.string())]).optional()}),d=s.z.object({rule_definitions:s.z.record(s.z.string(),r).optional(),org_overrides:s.z.record(s.z.string(),r).optional()});function o(){let{activeOrganization:e}=(0,i.YL)(),t=(0,i.mV)(),a=(0,i.zm)(),s=(0,i.zc)(),r=null==e?void 0:e.billing_type,{value:o}=(0,n.useDynamicConfig)("unified_limits_overage_provisioning"),u=(0,l.useMemo)(()=>{let e=d.safeParse(o);return e.success?e.data:null},[o]);return(0,l.useMemo)(()=>{let i;if(!u||!e||"stripe_subscription"!==r&&"stripe_subscription_contracted"!==r)return!1;let n=e.uuid;if(a)i="claude_enterprise";else if(t&&!a)i="claude_team";else{if(!s)return!1;i="claude_max"}if(u.org_overrides&&n&&u.org_overrides[n]){let e=u.org_overrides[n];return"claude_max"===i||!!e.allowed_seat_tiers&&"all"===e.allowed_seat_tiers}if(u.rule_definitions){let t;switch(i){case"claude_max":t="claude_max";break;case"claude_enterprise":t="claude_enterprise";break;case"claude_team":t="claude_team";break;default:return!1}if(t&&u.rule_definitions[t]){let a=u.rule_definitions[t];if(a.allowed_rate_tiers){let t=e.rate_limit_tier;if(!t)return!1;if("string"==typeof a.allowed_rate_tiers){if(t!==a.allowed_rate_tiers)return!1}else if(Array.isArray(a.allowed_rate_tiers)&&!a.allowed_rate_tiers.includes(t))return!1}return!a.allowed_seat_tiers||"all"===a.allowed_seat_tiers}}return!1},[u,e,t,a,s,r])}},63836:(e,t,a)=>{a.d(t,{G:()=>w});var i=a(54568),n=a(44995),l=a(64328),s=a(45054),r=a(23812),d=a(54787),o=a(84617),u=a(20683),c=a(18868),m=a(61295),p=a(39109),x=a(7620),g=a(97509),v=a(10369),f=a(59666),y=a(91754),h=a(48579),_=a(28122),b=a(43314),j=a(66175);function w(e){let{onComplete:t,hasAutoReload:a=!1,onAutoReloadEnabled:w}=e,A=(0,v.A)(),{websiteBaseUrl:S}=(0,n._r)(),M=(0,l.mV)(),[N,z]=(0,x.useState)(500),[C,L]=(0,x.useState)(null),[k,P]=(0,x.useState)("idle"),[E,Q]=(0,x.useState)(!1),{data:T}=(0,b.OC)(),{data:D}=(0,b.WF)(),{data:K,mutate:q,isPending:O}=(0,h.Pz)({}),{addError:I}=(0,s.Y)(),{mutate:Y,isPending:U}=(0,b.v)({onSuccess:e=>{"pending_invoice"===e.payment_status&&e.purchase_id?(L(e.purchase_id),P("polling")):"success"===e.payment_status?P("success"):"requires_action"===e.payment_status&&e.payment_intent_client_secret&&(P("handling_3ds"),W({clientSecret:e.payment_intent_client_secret}))},onError:e=>{I(e.message||"Failed to purchase credits",{error:e}),P("error")}}),{data:F}=(0,b.sj)(C),{mutate:W,isPending:B}=(0,b.s6)({onSuccess:()=>{P("success")},onError:e=>{I(e.message||"Payment confirmation failed",{error:e}),P("error")}}),R=(null==D?void 0:D.currency)||(null==K?void 0:K.currency)||"USD",G=(0,x.useCallback)(e=>(0,u.vv)(e,R,{preferWholeNumber:!0}),[R]),V=(0,x.useCallback)(e=>{let t=parseFloat(e.replace(/[^0-9.]/g,""));return isNaN(t)?0:Math.round(100*t)},[]);(0,x.useEffect)(()=>{(null==F?void 0:F.status)==="action_needed"&&F.stripe_payment_intent_client_secret&&(P("handling_3ds"),W({clientSecret:F.stripe_payment_intent_client_secret}))},[F,W]),(0,x.useEffect)(()=>{(null==F?void 0:F.status)==="paid"?P("success"):(null==F?void 0:F.status)==="failed"&&P("error")},[F]),(0,x.useEffect)(()=>{"success"===k&&setTimeout(()=>{window.location.reload()},3e3)},[k]);let H=null==T?void 0:T.find(e=>e.isDefault),Z=(0,x.useCallback)(()=>{if(!H)return void I(A.formatMessage({defaultMessage:"No payment method found",id:"aFUEsXIPKo"}));P("purchasing"),Q(!0),Y({amount:N,redirect_url:window.location.href})},[H,I,A,N,Y]),X=(0,x.useCallback)(()=>{Q(!1),P("idle"),L(null)},[]),$=(0,x.useCallback)(()=>{Q(!1),P("idle"),setTimeout(()=>{Z()},100)},[Z]);(0,x.useEffect)(()=>{q({billingInterval:_.NW.MONTHLY,useSavedAddress:!0})},[q]);let J=K&&K.price>0?(K.taxAmount||0)/K.price:0,ee=N/100,et=Math.round(ee*J*100)/100,ea=N<500,ei=N>1e8,en=e=>{let{children:t,dismissable:a=!1,onDismiss:n}=e;return(0,x.useEffect)(()=>{if(a)return;let e=document.body.style.overflow;document.body.style.overflow="hidden";let t=e=>{e.stopPropagation(),e.preventDefault()},i=e=>{("Escape"===e.key||"Esc"===e.key)&&(e.stopPropagation(),e.preventDefault())};return document.addEventListener("pointerdown",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",i,!0),()=>{document.body.style.overflow=e,document.removeEventListener("pointerdown",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",i,!0)}},[a]),(0,i.jsxs)("div",{className:"fixed inset-0 z-[1000] flex h-full w-full items-center justify-center text-center text-always-white",role:"dialog","aria-modal":"true",onPointerDownCapture:e=>{a||(e.stopPropagation(),e.preventDefault())},onClickCapture:e=>{a?a&&n&&n():(e.stopPropagation(),e.preventDefault())},tabIndex:-1,children:[(0,i.jsx)(m.P.div,{className:"bg-accent-pro-100/90 absolute inset-0",exit:{opacity:0},transition:{duration:.35},onPointerDown:e=>{a||(e.stopPropagation(),e.preventDefault())},onClick:e=>{a||(e.stopPropagation(),e.preventDefault())}}),(0,i.jsx)(m.P.div,{className:"relative z-10 mb-4 min-h-[250px] max-w-3xl px-4",exit:{opacity:0,scale:.9},transition:{duration:.25},onPointerDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation(),children:t})]})},el=()=>(0,i.jsx)("svg",{className:"inline-block animate-spin",width:"80",height:"80",viewBox:"0 0 80 80",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("circle",{cx:"40",cy:"40",r:"37",stroke:"currentColor",strokeWidth:"4",fill:"none",strokeDasharray:"180 360",strokeLinecap:"round"})}),es=(0,x.useCallback)(()=>(0,i.jsxs)(en,{children:[(0,i.jsx)(el,{}),(0,i.jsx)("h2",{className:"font-ui mb-1 mt-4 text-2xl font-medium",children:"purchasing"===k?(0,i.jsx)(f.A,{defaultMessage:"Initiating purchase...",id:"njGoT/6Sfc"}):"handling_3ds"===k?(0,i.jsx)(f.A,{defaultMessage:"Completing payment verification...",id:"zR6/HCxxe9"}):(0,i.jsx)(f.A,{defaultMessage:"Processing payment...",id:"mk92iTLBDN"})}),(0,i.jsx)("p",{className:"text-lg",children:(0,i.jsx)(f.A,{defaultMessage:"Adding funds to your wallet",id:"a8xkz/h8Py"})})]}),[k]),er=(0,x.useCallback)(()=>(0,i.jsxs)(en,{children:[(0,i.jsx)(el,{}),(0,i.jsx)("div",{className:"absolute left-0 top-0 w-full flex justify-center",children:(0,i.jsxs)("svg",{className:"inline-block",width:"80",height:"80",viewBox:"0 0 80 80",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)(m.P.circle,{cx:"40",cy:"40",r:"37",stroke:"currentColor",strokeWidth:"4",strokeDasharray:"0 1",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:.65,ease:"easeInOut"}}),(0,i.jsx)(m.P.path,{d:"M26 40L36 51L56 29",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeDasharray:"0 1",initial:{pathLength:0,opacity:0},animate:{pathLength:1,opacity:[0,1,1,1,0]},transition:{duration:.35,delay:.5,ease:"easeInOut",opacity:{duration:1.25}}}),(0,i.jsxs)("g",{children:[(0,i.jsx)(m.P.path,{d:"M30.7075 22.75L19.0001 54.2499H25.5625L27.925 47.6349H40.21L42.5987 54.2499H49.1612L37.4275 22.75H30.7075ZM30.0775 41.7812L34.0675 30.7037L38.0837 41.7812H30.0775Z",fill:"currentColor",initial:{opacity:0,x:-6},animate:{opacity:1,x:0},transition:{ease:[.075,.82,.165,1],duration:.5,delay:1.75}}),(0,i.jsx)(m.P.path,{d:"M42.8613 22.75H49.2926L61 54.2499H54.5688L42.8613 22.75Z",fill:"currentColor",initial:{opacity:0,x:6},animate:{opacity:1,x:0},transition:{ease:[.075,.82,.165,1],duration:.5,delay:1.75}})]})]})}),(0,i.jsx)(m.P.h2,{className:"font-ui mt-2 text-4xl font-medium",initial:{opacity:0,x:-24},animate:{opacity:1,x:0},transition:{ease:[.075,.82,.165,1],duration:1,delay:.75},children:(0,i.jsx)(f.A,{defaultMessage:"Purchase successful",id:"L67/zTKBr/"})})]}),[]),ed=(0,x.useCallback)(()=>(0,i.jsxs)(en,{dismissable:!0,onDismiss:X,children:[(0,i.jsx)("div",{className:"bg-oncolor-100/10 inline-block rounded-full p-5",children:(0,i.jsx)(c.N,{size:40,className:"-translate-y-px"})}),(0,i.jsx)("h2",{className:"font-ui mb-1 mt-3 text-2xl font-medium",children:(0,i.jsx)(f.A,{defaultMessage:"Payment failed",id:"qV+TFmE3ks"})}),(0,i.jsx)("p",{className:"text-lg mb-6",children:(0,i.jsx)(f.A,{defaultMessage:"Looks like that payment didn’t go through.",id:"CuToDD14Tj"})}),(0,i.jsx)(o.Y,{onClick:$,children:(0,i.jsx)(f.A,{defaultMessage:"Try again",id:"FazwRldA7z"})})]}),[$,X]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-text-100 mb-2",children:(0,i.jsx)(f.A,{defaultMessage:"Cover usage beyond your subscription limits by adding funds to your wallet",id:"5TUxihkd1r"})}),(0,i.jsx)("input",{type:"text",value:G(N),onChange:e=>{z(V(e.target.value))},placeholder:G(500),className:"w-full px-3 py-2 bg-bg-000 border border-border-300 rounded-lg text-text-100 focus:outline-none focus:ring-2 focus:ring-bg-500 focus:border-text-000"}),ea&&(0,i.jsx)("p",{className:"text-sm text-danger-000 mt-2",children:(0,i.jsx)(f.A,{defaultMessage:"Minimum amount is {minAmount}",id:"UfgPiUtfvp",values:{minAmount:G(500)}})}),ei&&(0,i.jsx)("p",{className:"text-sm text-danger-000 mt-2",children:(0,i.jsx)(f.A,{defaultMessage:"Maximum amount is {maxAmount}",id:"Ej2QcxFwd7",values:{maxAmount:G(1e8)}})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("div",{className:"flex justify-between text-text-100 border-b border-border-300",children:[(0,i.jsx)("span",{className:"mb-4",children:(0,i.jsx)(f.A,{defaultMessage:"Wallet balance after purchase",id:"srgMWtE+3j"})}),(0,i.jsx)("span",{className:"text-text-100 font-medium",children:(0,i.jsx)(y.Gr,{value:(((null==D?void 0:D.amount)||0)+N)/100,style:"currency",currency:R})})]}),(0,i.jsxs)("div",{className:"flex justify-between text-text-100",children:[(0,i.jsx)("span",{children:(0,i.jsx)(f.A,{defaultMessage:"Add to wallet",id:"oFLXgfOlLS"})}),(0,i.jsx)("span",{children:(0,i.jsx)(y.Gr,{value:ee,style:"currency",currency:R})})]}),O?(0,i.jsxs)("div",{className:"flex justify-between text-text-100",children:[(0,i.jsx)("span",{children:(0,i.jsx)(f.A,{defaultMessage:"Estimated tax",id:"0g76tiPW7S"})}),(0,i.jsx)(d.j,{height:18,width:50})]}):et>0?(0,i.jsxs)("div",{className:"flex justify-between text-text-100",children:[(0,i.jsx)("span",{children:(0,i.jsx)(f.A,{defaultMessage:"Estimated tax",id:"0g76tiPW7S"})}),(0,i.jsx)("span",{children:(0,i.jsx)(y.Gr,{value:et,style:"currency",currency:R})})]}):null,(0,i.jsxs)("div",{className:"flex justify-between text-text-100 font-medium",children:[(0,i.jsx)("span",{children:(0,i.jsx)(f.A,{defaultMessage:"Total due",id:"yVWciPrAq4"})}),(0,i.jsx)("span",{children:(0,i.jsx)(y.Gr,{value:ee+et,style:"currency",currency:R})})]})]}),(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)(j.x,{})}),(0,i.jsxs)("div",{className:"flex flex-col gap-3",children:[!M&&(0,i.jsx)("p",{className:"text-text-300 text-sm",children:(0,i.jsx)(f.A,{defaultMessage:"By clicking Purchase, you allow Anthropic to charge your card in the amount above.",id:"R4PT4S5XC7"})}),(0,i.jsxs)(r.$,{variant:"primary",onClick:Z,loading:U||B||"polling"===k,size:"lg",disabled:!H||"idle"!==k||ea||ei,className:"w-full",children:["purchasing"===k&&(0,i.jsx)(f.A,{defaultMessage:"Processing...",id:"6OWS4p9SXV"}),"polling"===k&&(0,i.jsx)(f.A,{defaultMessage:"Processing payment...",id:"mk92iTLBDN"}),"handling_3ds"===k&&(0,i.jsx)(f.A,{defaultMessage:"Completing payment verification...",id:"zR6/HCxxe9"}),"idle"===k&&(0,i.jsx)(f.A,{defaultMessage:"Purchase",id:"J6EydslpYB"})]}),M&&(0,i.jsx)("p",{className:"text-text-300 text-sm",children:(0,i.jsx)(f.A,{defaultMessage:"By clicking Purchase, you agree to Anthropic’s <link>Commercial Terms of Service</link>. Deposits to wallet expire 1 year after purchase, subject to applicable law.",id:"zdAeLN1q3A",values:{link:e=>(0,i.jsx)(o.Y,{href:"".concat(S,"/legal/commercial-terms"),target:"_blank",children:e})}})})]})]}),"undefined"!=typeof document&&(0,g.createPortal)((0,i.jsxs)(p.N,{children:[E&&("purchasing"===k||"polling"===k||"handling_3ds"===k)&&es(),E&&"success"===k&&er(),E&&"error"===k&&ed()]}),document.body)]})}},66175:(e,t,a)=>{a.d(t,{B:()=>u,x:()=>c});var i=a(54568),n=a(23812),l=a(58509),s=a(7620),r=a(59666),d=a(43314),o=a(48801);function u(){let{data:e}=(0,d.OC)();return!!(null==e?void 0:e.find(e=>e.isDefault))}function c(){let[e,t]=(0,s.useState)(!1),{data:a,refetch:u}=(0,d.OC)(),c=null==a?void 0:a.find(e=>e.isDefault);return(0,i.jsxs)(i.Fragment,{children:[c?(0,i.jsxs)("div",{className:"flex items-center justify-between p-5 border border-border-300 rounded-lg",children:[(0,i.jsx)("span",{className:"text-text-100 font-medium",children:(0,i.jsx)(r.A,{defaultMessage:"Payment method",id:"BVTni9A2ca"})}),(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("span",{className:"text-text-100",children:(0,i.jsx)(r.A,{defaultMessage:"{type} •••• {last4}",id:"77zI4ZND0O",values:{type:c.type.toUpperCase(),last4:c.last4}})}),(0,i.jsx)(n.$,{variant:"ghost",size:"icon_sm",onClick:()=>t(!0),children:(0,i.jsx)(l.Z,{size:18,className:"text-text-400"})})]})]}):(0,i.jsxs)("div",{className:"flex items-center justify-between p-5 border border-border-300 rounded-lg",children:[(0,i.jsx)("span",{className:"text-text-100 font-medium",children:(0,i.jsx)(r.A,{defaultMessage:"Payment method",id:"BVTni9A2ca"})}),(0,i.jsx)(n.$,{variant:"secondary",size:"default",onClick:()=>t(!0),children:(0,i.jsx)(r.A,{defaultMessage:"Add payment method",id:"+EIsonKmCI"})})]}),(0,i.jsx)(o.J,{isOpen:e,onClose:()=>t(!1),onPaymentMethodUpdated:()=>{u(),t(!1)}})]})}}}]);
try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},a=(new e.Error).stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="621b82a5-d18f-4dd3-a043-e21841dae101",e._sentryDebugIdIdentifier="sentry-dbid-621b82a5-d18f-4dd3-a043-e21841dae101")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7415],{8667:(e,a,l)=>{l.d(a,{b:()=>n});let r=["AT","BE","BG","CY","CZ","DE","DK","EE","ES","FI","FR","GR","HR","HU","IE","IT","LT","LU","LV","MT","NL","PL","PT","RO","SE","SI","SK"],n=e=>r.includes(e.toUpperCase())||"GB"===e.toUpperCase()},21491:(e,a,l)=>{l.d(a,{CB:()=>p,He:()=>b,Hm:()=>m,QS:()=>y,u6:()=>d,uA:()=>c});var r=l(54568),n=l(59666),t=l(28122),i=l(56162),o=l(72398),s=l(78433),u=l(8667);let d=(e,a)=>"raven"===e?a?(0,r.jsx)(n.A,{defaultMessage:"Subscribed to Enterprise plan",id:"mG2LirIcbi"}):(0,r.jsx)(n.A,{defaultMessage:"Subscribed to Team plan",id:"kVZjU0+6gW"}):"claude_max"===e?(0,r.jsx)(n.A,{defaultMessage:"Subscribed to Max",id:"Q2VUhBlhYA"}):"claude_pro"===e?(0,r.jsx)(n.A,{defaultMessage:"Subscribed to Pro",id:"dE1OUYZoXX"}):void 0,c=(e,a,l)=>"raven"===e?l:"claude_max"===e?a?(0,r.jsx)(n.A,{defaultMessage:"Thanks for subscribing to Max, {name}",id:"hsYvnBc6s2",values:{name:a}}):(0,r.jsx)(n.A,{defaultMessage:"Thanks for subscribing to Max",id:"iVdR3nJo+0"}):"claude_pro"===e?a?(0,r.jsx)(n.A,{defaultMessage:"Thanks for being a Pro, {name}",id:"zJWRxxb0KK",values:{name:a}}):(0,r.jsx)(n.A,{defaultMessage:"Thanks for being a Pro",id:"fPG6HsZUWT"}):void 0,p=e=>{switch(e){case"free":return(0,r.jsx)(i.s,{});case"claude_pro":return(0,r.jsx)(s.j,{});case"claude_max":return(0,r.jsx)(o.i,{})}},b=(e,a)=>{switch(e){case"raven":return a?(0,r.jsx)(n.A,{defaultMessage:"Enterprise plan",id:"0g7deXDj3b"}):(0,r.jsx)(n.A,{defaultMessage:"Team plan",id:"idguOo+PzU"});case"free":return(0,r.jsx)(n.A,{defaultMessage:"Free plan",id:"B+7815cfpz"});case"claude_pro":return(0,r.jsx)(n.A,{defaultMessage:"Pro plan",id:"P0xe8AvKVP"});case"claude_max":return(0,r.jsx)(n.A,{defaultMessage:"Max plan",id:"yC6ECfKPIQ"})}},m=(e,a,l)=>"free"===e?(0,r.jsx)(n.A,{defaultMessage:"Try Claude",id:"pZ4CtGSlwT"}):"claude_pro"===e&&a===t.NW.YEARLY?(0,r.jsx)(n.A,{defaultMessage:"Annual",id:"2C6TrW95uE"}):"claude_pro"===e&&a===t.NW.MONTHLY?(0,r.jsx)(n.A,{defaultMessage:"Monthly",id:"wYsv4ZHu+B"}):"claude_max"===e&&l===t.un.FIVE_X?(0,r.jsx)(n.A,{defaultMessage:"5x more usage than Pro",id:"Mqu1u9b9B1"}):"claude_max"===e&&l===t.un.TWENTY_X?(0,r.jsx)(n.A,{defaultMessage:"20x more usage than Pro",id:"YIkI1PRwfs"}):void 0,y=e=>e&&(0,u.b)(e)?(0,r.jsx)(n.A,{defaultMessage:"Subscribe and Pay",id:"Zt/6SnhrDf"}):(0,r.jsx)(n.A,{defaultMessage:"Subscribe",id:"gczcC5Leue"})},49737:(e,a,l)=>{l.d(a,{w:()=>n});var r=l(7620);let n=(e,a,l,n)=>(0,r.useMemo)(()=>{{let e=getComputedStyle(document.body);return"hsl(".concat(e.getPropertyValue("--".concat(n)),")")}},[l,n,a,e])},50719:(e,a,l)=>{l.d(a,{D:()=>s});var r=l(68067),n=l(7620),t=l(24407);let i={},o=t.z.record(t.z.object({name:t.z.string(),console_supported:t.z.boolean(),phone_verification_supported:t.z.boolean(),stripe_address_supported:t.z.boolean(),claudeai_supported:t.z.boolean()})),s=e=>{let{regions:a}=(()=>{let e=(0,r.iW)("supported_regions",i,o);return(0,n.useMemo)(()=>({regions:Object.entries(e).map(e=>{let[a,l]=e;return{code:a,...l}})}),[e])})();return(0,n.useMemo)(()=>({supportedRegions:a.filter(a=>"claude-ai"===e?a.claudeai_supported:"console"===e?a.console_supported:void 0)}),[a,e])}},77223:(e,a,l)=>{l.d(a,{bN:()=>m,Ri:()=>c,ib:()=>b});var r=l(80688),n=l(7620),t=l(1613),i=l(44995),o=l(64328),s=l(40459);let u=async e=>{if(s.env.NEXT_PUBLIC_DISABLE_PAYMENTS)return Promise.resolve(null);let{loadStripe:a}=await l.e(3508).then(l.bind(l,13508));return a(e)},d=["ar","bg","cs","da","de","el","en","en-AU","en-CA","en-NZ","en-GB","es","es-ES","es-419","et","fi","fil","fr","fr-CA","fr-FR","he","hu","hr","id","it","it-IT","ja","ko","lt","lv","ms","mt","nb","nl","no","pl","pt","pt-BR","ro","ru","sk","sl","sv","th","tr","vi","zh","zh-HK","zh-TW"],c=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],{activeOrganization:a}=(0,o.YL)(),{data:l,mutate:i,isIdle:s}=(0,t.L2)("/api/stripe/".concat(null==a?void 0:a.uuid,"/intent"),"POST",{enabled:!!(null==a?void 0:a.uuid),retry:2,retryDelay:2e3,mutationKey:[r.$k,null==a?void 0:a.uuid]});return(0,n.useEffect)(()=>{s&&e&&i()},[i,s,e]),l},p=null,b=()=>{let{stripePublishableKey:e}=(0,i._r)();return p||(p=u(e)),p},m=e=>{if(d.includes(e))return e;let a=e.split("-")[0];return d.includes(a)?a:"en"}},97415:(e,a,l)=>{l.d(a,{n:()=>R});var r=l(54568),n=l(55562),t=l(77223),i=l(1720),o=l(49737),s=l(19069),u=l(39613),d=l(17333),c=l(72902),p=l(7620),b=l(10369),m=l(74813),y=l(64328),h=l(93112),_=l(50719),g=l(23812),v=l(13750),f=l(54728),x=l(78204),A=l.n(x);let k=[{key:"ad_nrt",label:"Andorran NRT number",countries:["AD"],placeholder:"A-123456-Z"},{key:"ar_cuit",label:"Argentinian tax ID number",countries:["AR"],placeholder:"12-3456789-01"},{key:"au_abn",label:"Australian Business Number (AU ABN)",countries:["AU"],placeholder:"12345678912"},{key:"au_arn",label:"Australian Taxation Office Reference Number",countries:["AU"],placeholder:"123456789123"},{key:"eu_vat",label:"European VAT number",countries:["AT"],placeholder:"ATU12345678"},{key:"eu_vat",label:"European VAT number",countries:["BE"],placeholder:"BE0123456789"},{key:"bo_tin",label:"Bolivian tax ID",countries:["BO"],placeholder:"123456789"},{key:"br_cnpj",label:"Brazilian CNPJ number",countries:["BR"],placeholder:"01.234.456/5432-10"},{key:"br_cpf",label:"Brazilian CPF number",countries:["BR"],placeholder:"123.456.789-87"},{key:"bg_uic",label:"Bulgaria Unified Identification Code",countries:["BG"],placeholder:"123456789"},{key:"eu_vat",label:"European VAT number",countries:["BG"],placeholder:"BG0123456789"},{key:"ca_bn",label:"Canadian BN",countries:["CA"],placeholder:"123456789"},{key:"ca_gst_hst",label:"Canadian GST/HST number",countries:["CA"],placeholder:"123456789RT0002"},{key:"ca_pst_bc",label:"Canadian PST number (BC)",countries:["CA"],placeholder:"PST-1234-5678"},{key:"ca_pst_mb",label:"Canadian PST number (MB)",countries:["CA"],placeholder:"123456-7"},{key:"ca_pst_sk",label:"Canadian PST number (SK)",countries:["CA"],placeholder:"1234567"},{key:"ca_qst",label:"Canadian QST number (Qu\xe9bec)",countries:["CA"],placeholder:"1234567890TQ1234"},{key:"cl_tin",label:"Chilean TIN",countries:["CL"],placeholder:"12.345.678-K"},{key:"cn_tin",label:"Chinese tax ID",countries:["CN"],placeholder:"123456789012345678"},{key:"co_nit",label:"Colombian NIT number",countries:["CO"],placeholder:"123.456.789-0"},{key:"cr_tin",label:"Costa Rican tax ID",countries:["CR"],placeholder:"1-234-567890"},{key:"eu_vat",label:"European VAT number",countries:["HR"],placeholder:"HR12345678912"},{key:"eu_vat",label:"European VAT number",countries:["CY"],placeholder:"CY12345678Z"},{key:"eu_vat",label:"European VAT number",countries:["CZ"],placeholder:"CZ1234567890"},{key:"eu_vat",label:"European VAT number",countries:["DK"],placeholder:"DK12345678"},{key:"do_rcn",label:"Dominican RCN number",countries:["DO"],placeholder:"123-4567890-1"},{key:"ec_ruc",label:"Ecuadorian RUC number",countries:["EC"],placeholder:"1234567890001"},{key:"eg_tin",label:"Egyptian TIN",countries:["EG"],placeholder:"123456789"},{key:"sv_nit",label:"El Salvadorian NIT number",countries:["SV"],placeholder:"1234-567890-123-4"},{key:"eu_vat",label:"European VAT number",countries:["EE"],placeholder:"EE123456789"},{key:"eu_oss_vat",label:"European One Stop Shop VAT number",countries:["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE"],placeholder:"EU123456789",last:!0},{key:"eu_vat",label:"European VAT number",countries:["FI"],placeholder:"FI12345678"},{key:"eu_vat",label:"European VAT number",countries:["FR"],placeholder:"FRAB123456789"},{key:"ge_vat",label:"Georgian VAT",countries:["GE"],placeholder:"123456789"},{key:"eu_vat",label:"European VAT number",countries:["DE"],placeholder:"DE123456789"},{key:"eu_vat",label:"European VAT number",countries:["GR"],placeholder:"EL123456789"},{key:"hk_br",label:"Hong Kong BR number",countries:["HK"],placeholder:"12345678"},{key:"eu_vat",label:"European VAT number",countries:["HU"],placeholder:"HU12345678"},{key:"hu_tin",label:"Hungary tax number (ad\xf3sz\xe1m)",countries:["HU"],placeholder:"12345678-1-23"},{key:"is_vat",label:"Icelandic VAT",countries:["IS"],placeholder:"123456"},{key:"in_gst",label:"Indian GST number",countries:["IN"],placeholder:"12ABCDE3456FGZH"},{key:"id_npwp",label:"Indonesian NPWP number",countries:["ID"],placeholder:"12.345.678.9-012.345"},{key:"eu_vat",label:"European VAT number",countries:["IE"],placeholder:"IE1234567AB"},{key:"il_vat",label:"Israel VAT",countries:["IL"],placeholder:"000012345"},{key:"eu_vat",label:"European VAT number",countries:["IT"],placeholder:"IT12345678912"},{key:"jp_cn",label:"Japanese Corporate Number",countries:["JP"],placeholder:"1234567891234"},{key:"jp_rn",label:"Japanese Registered Foreign Businesses’ Registration Number",countries:["JP"],placeholder:"12345"},{key:"jp_trn",label:"Japanese Tax Registration Number",countries:["JP"],placeholder:"T1234567891234"},{key:"ke_pin",label:"KRA PIN",countries:["KE"],placeholder:"P000111111A"},{key:"eu_vat",label:"European VAT number",countries:["LV"],placeholder:"LV12345678912"},{key:"li_uid",label:"Liechtensteinian UID number",countries:["LI"],placeholder:"CHE123456789"},{key:"eu_vat",label:"European VAT number",countries:["LT"],placeholder:"LT123456789123"},{key:"eu_vat",label:"European VAT number",countries:["LU"],placeholder:"LU12345678"},{key:"my_frp",label:"Malaysian FRP number",countries:["MY"],placeholder:"12345678"},{key:"my_itn",label:"Malaysian ITN",countries:["MY"],placeholder:"C 1234567890"},{key:"my_sst",label:"Malaysian SST number",countries:["MY"],placeholder:"A12-3456-78912345"},{key:"eu_vat",label:"European VAT number",countries:["MT"],placeholder:"MT12345678"},{key:"mx_rfc",label:"Mexican RFC number",countries:["MX"],placeholder:"ABC010203AB9"},{key:"eu_vat",label:"European VAT number",countries:["NL"],placeholder:"NL123456789B12"},{key:"nz_gst",label:"New Zealand GST number",countries:["NZ"],placeholder:"123456789"},{key:"no_vat",label:"Norwegian VAT number",countries:["NO"],placeholder:"123456789MVA"},{key:"no_voec",label:"Norwegian VAT on e-commerce number",countries:["NO"],placeholder:"1234567"},{key:"pe_ruc",label:"Peruvian RUC number",countries:["PE"],placeholder:"12345678901"},{key:"ph_tin",label:"Philippines Tax Identification Number",countries:["PH"],placeholder:"123456789012"},{key:"eu_vat",label:"European VAT number",countries:["PL"],placeholder:"PL1234567890"},{key:"eu_vat",label:"European VAT number",countries:["PT"],placeholder:"PT123456789"},{key:"eu_vat",label:"European VAT number",countries:["RO"],placeholder:"RO1234567891"},{key:"ro_tin",label:"Romanian tax ID number",countries:["RO"],placeholder:"1234567890123"},{key:"ru_inn",label:"Russian INN",countries:["RU"],placeholder:"1234567891"},{key:"ru_kpp",label:"Russian KPP",countries:["RU"],placeholder:"123456789"},{key:"sa_vat",label:"Saudi Arabia VAT",countries:["SA"],placeholder:"123456789012345"},{key:"rs_pib",label:"Serbian PIB number",countries:["RS"],placeholder:"123456789"},{key:"sg_gst",label:"Singaporean GST",countries:["SG"],placeholder:"M12345678X"},{key:"sg_uen",label:"Singaporean UEN",countries:["SG"],placeholder:"123456789F"},{key:"eu_vat",label:"European VAT number",countries:["SK"],placeholder:"SK1234567891"},{key:"eu_vat",label:"European VAT number",countries:["SI"],placeholder:"SI12345678"},{key:"si_tin",label:"Slovenia tax number (davčna številka)",countries:["SI"],placeholder:"12345678"},{key:"za_vat",label:"South African VAT number",countries:["ZA"],placeholder:"4123456789"},{key:"kr_brn",label:"Korean BRN",countries:["KR"],placeholder:"123-45-67890"},{key:"es_cif",label:"Spanish NIF number",countries:["ES"],placeholder:"A12345678"},{key:"eu_vat",label:"European VAT number",countries:["ES"],placeholder:"ESA1234567Z"},{key:"eu_vat",label:"European VAT number",countries:["SE"],placeholder:"SE123456789123"},{key:"ch_vat",label:"Switzerland VAT number",countries:["CH"],placeholder:"CHE-123.456.789 MWST"},{key:"tw_vat",label:"Taiwanese VAT",countries:["TW"],placeholder:"12345678"},{key:"th_vat",label:"Thai VAT",countries:["TH"],placeholder:"1234567891234"},{key:"tr_tin",label:"Turkish Tax Identification Number",countries:["TR"],placeholder:"0123456789"},{key:"ua_vat",label:"Ukrainian VAT",countries:["UA"],placeholder:"123456789"},{key:"ae_trn",label:"United Arab Emirates TRN",countries:["AE"],placeholder:"123456789012345"},{key:"eu_vat",label:"Northern Ireland VAT number",countries:["XI"],placeholder:"XI123456789"},{key:"gb_vat",label:"United Kingdom VAT number",countries:["GB"],placeholder:"GB123456789"},{key:"uy_ruc",label:"Uruguayan RUC number",countries:["UY"],placeholder:"123456789012"},{key:"ve_rif",label:"Venezuelan RIF number",countries:["VE"],placeholder:"A-12345678-9"},{key:"vn_tin",label:"Vietnamese tax ID number",countries:["VN"],placeholder:"1234567890"}],T=e=>{let{title:a,subtitle:l,countryCode:n,className:t,inputClassName:i,textClassName:o,taxIdType:s,onTaxIdTypeChange:u,taxId:d,onTaxIdChange:b,size:m,autoSelectFirst:y=!1,disabled:h}=e,_=(0,p.useMemo)(()=>{let e={};return k.forEach(a=>{a.countries.forEach(l=>{l in e?e[l].push(a):e[l]=[a]})}),e},[]),g=(0,p.useMemo)(()=>n&&A().sortBy(_[n],e=>e.last?2:1,e=>e.label)||[],[n,_]),x=(0,p.useMemo)(()=>Object.fromEntries(g.map(e=>[e.key,e])),[g]),T=(0,p.useMemo)(()=>s?x[s]:null,[x,s]),E=g.length>0;return(0,p.useEffect)(()=>{n&&0===g.length&&(u(void 0),b("")),(1===g.length||g.length>0&&y)&&u(g[0].key)},[g,n,b,u,y]),(0,r.jsx)("div",{hidden:!E,children:(0,r.jsxs)("div",{className:(0,c.A)(t,o,"flex flex-col"),children:[(0,r.jsx)("div",{className:(0,c.A)("text-text-100 text-sm",o),children:a}),l&&(0,r.jsx)("div",{className:"text-text-400 text-xs",children:l}),(0,r.jsxs)("div",{className:"mt-2 inline-flex w-full flex-wrap items-center gap-2",children:[1===g.length?(0,r.jsx)("label",{htmlFor:"tax-id-text",className:"text-sm",children:g[0].label}):(0,r.jsx)(f.g,{disabled:!E||h,options:g,placeholder:"Select tax ID type",selected:T,onSelect:e=>{u(e.key),b("")},className:(0,c.A)("min-w-[12rem]",i),textClassName:o,size:m,type:"primary"}),(0,r.jsx)(v.ks,{value:d,id:"tax-id-text",disabled:h,hidden:!T,placeholder:null==T?void 0:T.placeholder,onValueChange:e=>b(e||""),className:(0,c.A)("border-border-200 hover:border-border-100 w-48 border",i),type:"text",size:"md"===m?"default":m})]})]})})};var E=l(59666),S=l(48579),I=l(28122),C=l(21491),N=l(17300);function M(e){let{taxId:a,taxIdType:l,isChecked:n,onCheck:t}=e,i=(0,b.A)();return"au_abn"===l&&a.length>0?(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(N.S,{checked:n,onChange:t,label:i.formatMessage({id:"efQ78fRCLf",defaultMessage:"My business is registered for GST and the ABN number I have provided is valid."})})}):null}function P(e){let{onReady:a,onCancel:l,defaultCountry:n,setAddress:t,setTaxParams:i,action:o,children:s,returnPath:u,onPaymentMethodUpdated:v,legalAccepted:f,...x}=e,A=(0,b.A)(),k=(0,m.st)(),I=(0,d.useStripe)(),N=(0,d.useElements)(),{account:P}=(0,y.YL)(),{data:R}=(0,h.Hc)(),{supportedRegions:V}=(0,_.D)("claude-ai"),w=(0,p.useMemo)(()=>V.filter(e=>e.stripe_address_supported).map(e=>e.code),[V]),[B,L]=(0,p.useState)("claude-ai"===x.product?x.companyName:void 0),U=(0,p.useMemo)(()=>"claude-ai"===x.product?{...x,companyName:B}:x,[x,B]),[D,z]=(0,p.useState)(null),[H,G]=(0,p.useState)(!1),[F,K]=(0,p.useState)(!1),[Y,O]=(0,p.useState)(null),[Z,W]=(0,p.useState)(""),[X,J]=(0,p.useState)(),[Q,q]=(0,p.useState)(!1),$=(0,p.useMemo)(()=>""!==Z&&X?{type:X,value:Z}:void 0,[Z,X]);(0,p.useEffect)(()=>{null==i||i($)},[$,i]);let ee=j(G,U),{mutateAsync:ea,error:el}=(0,S.uS)();(0,p.useEffect)(()=>{el&&z(el.message)},[el]);let er=(e,a)=>{let l=new URL(e.toString());a&&(l.pathname+="/".concat(a));let r=new URLSearchParams(l.search);return r.set("action","subscribe"),r.set("redirect_status","succeeded"),"claude-ai"===U.product&&U.plan&&r.set("plan",U.plan),l.search=r.toString(),l},en=async()=>{let e;if(H||!I||!N)return;let a=N.getElement("address");if(!a)return;G(!0);let l=new URL(window.location.origin),r=u.split("?");l.pathname=r[0];let n=new URLSearchParams(r[1]||"");n.set("action",o),"claude-ai"===U.product&&U.plan&&n.set("plan",U.plan),l.search=n.toString();let t="claude-ai"===U.product?U.plan:"team";if("subscribe"===o){k.track({event_key:"claudeai.pricing.payment_form_submitted",plan_type:t,billing_interval:U.billingInterval,has_promo:!!R,promo_code:(null==R?void 0:R.proMonthlyPromoCode)||(null==R?void 0:R.proAnnualPromoCode),has_tax_id:!!Z});let r=await N.submit();if(r.error)e=r.error;else{let r=(await a.getValue()).value.address,n={line1:r.line1,city:r.city,country:r.country,region:r.state,postalCode:r.postal_code,tax_id:$,billingInterval:U.billingInterval},t=await ee(n),o=t.clientSecret;if("setupIntentId"in t&&t.setupIntentId&&!t.organization_id){var i;let a=await I.confirmSetup({elements:N,clientSecret:o,redirect:"if_required",confirmParams:{return_url:l.toString()}});if(a.error||(null==(i=a.setupIntent)?void 0:i.status)!=="succeeded")e=a.error;else{let r={...n,verified_setup_intent_id:a.setupIntent.id,company_name:B,plan:"claude-ai"===U.product?U.plan:void 0};try{let a=await ee(r);if(a.clientSecret&&!a.isPendingSetupIntent){let r=er(l,a.organization_id);e=(await I.confirmPayment({elements:N,clientSecret:a.clientSecret,confirmParams:{return_url:r.toString()}})).error}else{let e=er(l,a.organization_id);window.location.href=e.toString()}}catch(e){z((e instanceof Error?e.message:void 0)||A.formatMessage({defaultMessage:"Failed to create subscription. Please try again.",id:"2cTonaP1h4"})),G(!1);return}}}else{t.organization_id&&(l.pathname+="/".concat(t.organization_id));let a={elements:N,clientSecret:o,confirmParams:{return_url:l.toString()}};e=(t.isPendingSetupIntent?await I.confirmSetup(a):await I.confirmPayment(a)).error}}(null==e?void 0:e.message)&&"validation_error"!==e.type&&(z(e.message),k.track({event_key:"claudeai.pricing.payment_failed",error_type:e.type,error_code:e.code,error_message:e.message,action:"update_payment_method",plan_type:t,billing_interval:U.billingInterval})),G(!1)}else{let{error:e}=await I.confirmSetup({elements:N,redirect:"if_required",confirmParams:{return_url:l.toString()}});if(e)e.message&&"validation_error"!==e.type&&z(e.message),e.type&&"validation_error"!==e.type&&k.track({event_key:"claudeai.pricing.payment_failed",error_type:e.type,error_code:e.code,error_message:e.message,action:"update_payment_method",plan_type:t,billing_interval:U.billingInterval});else try{await ea({tax_id:$,remove_tax_id:!$,company_name:B}),v&&v()}catch(e){z((e instanceof Error?e.message:void 0)||A.formatMessage({defaultMessage:"Failed to update tax information. Please try again.",id:"o7RpaY2p01"}))}G(!1)}};(0,p.useEffect)(()=>{let e=null==N?void 0:N.getElement("address");if(!e)return;let a=e=>{let a=e.value.address;O(a),null==t||t({line1:a.line1,city:a.city,country:a.country,region:a.state,postalCode:a.postal_code,billingInterval:U.billingInterval}),e.value.name&&L(e.value.name)};return e.on("change",a),()=>{e.off("change",a)}},[N,t,U.billingInterval]);let et="subscribe"===o?(0,C.QS)(null==Y?void 0:Y.country):(0,r.jsx)(E.A,{defaultMessage:"Update",id:"BWpuKlRSA1"});return(0,r.jsxs)("form",{id:"payment-form",onSubmit:e=>{e.preventDefault(),H||en()},className:(0,c.A)("subscribe"===o&&"p-5 bg-bg-100 border-0.5 border-border-400 rounded-md text-text-200"),children:[(0,r.jsx)("div",{className:"text-text-000 text-base font-medium mb-4",children:(0,r.jsx)(E.A,{defaultMessage:"Payment method",id:"BVTni9A2ca"})}),(0,r.jsx)(d.AddressElement,{options:{mode:"billing",allowedCountries:w,defaultValues:{name:null==P?void 0:P.full_name,address:n?{country:n}:void 0}},onChange:e=>{e.value.address.country!==(null==Y?void 0:Y.country)&&(J(void 0),W(""))}}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(d.PaymentElement,{id:"payment-element",options:{readOnly:H,layout:"tabs",terms:{card:"never"},defaultValues:{billingDetails:{email:null==P?void 0:P.email_address,name:null==P?void 0:P.full_name}}},onReady:()=>{K(!0),a&&a()}})}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)(T,{title:A.formatMessage({id:"Da5iekR76B",defaultMessage:"Business tax ID (Optional)"}),subtitle:A.formatMessage({id:"KpCyzHnEGv",defaultMessage:"If you provide a tax ID, the “Full name” above should be your business’s name."}),countryCode:null==Y?void 0:Y.country,taxId:Z,onTaxIdChange:e=>{W(e),q(!1)},taxIdType:X,onTaxIdTypeChange:e=>{J(e),q(!1)},inputClassName:"text-md rounded-md flex-grow",textClassName:"font-system text-md",size:"lg"}),(0,r.jsx)(M,{taxId:Z,taxIdType:X,isChecked:Q,onCheck:q})]}),D&&(0,r.jsx)("div",{className:"text-danger-000 mt-4",id:"payment-message",children:D}),(0,r.jsxs)("div",{className:"mt-5 flex flex-row flex-wrap items-center justify-end gap-3",children:[s,l&&(0,r.jsx)(g.$,{variant:"outline",size:"default",onClick:l,children:(0,r.jsx)(E.A,{defaultMessage:"Cancel",id:"47FYwba+bI"})}),(0,r.jsx)(g.$,{type:"submit",loading:H,variant:"primary",className:"subscribe"===o?"py-3 w-full":"",size:"subscribe"===o?"lg":"default",disabled:H||!F||"au_abn"===X&&Z.length>0&&!Q||"subscribe"===o&&!1===f,children:et})]})]})}let j=(e,a)=>{var l,r;let{mutateAsync:n}=(0,S.Xt)(),{mutateAsync:t}=(0,S.PQ)(),{mutateAsync:i}=(0,S.Nb)(),o="claude-ai"===a.product&&(null==(l=a.trialInfo)?void 0:l.available)===!0&&(null==(r=a.trialInfo)?void 0:r.requires_payment_upfront)===!0,{mutateAsync:s}=(0,S.cR)(),{data:u}=(0,S.jN)(),{data:d}=(0,h.Hc)(),c=(null==u?void 0:u.status)==="trialing"&&!(null==u?void 0:u.payment_method);return(0,p.useCallback)(l=>{if("raven"===a.product)return n({...l,organization_name:a.organizationName,members:a.members.filter(e=>e.includes("@")),billingInterval:a.billingInterval},{onError:()=>{e(!1)}});if(c&&!a.plan)return s({billing_interval:a.billingInterval},{onError:()=>{e(!1)}}).then(e=>({clientSecret:e.clientSecret||"",isPendingSetupIntent:!0,organization_id:void 0}));let r=a.promoCode;!r&&(a.billingInterval===I.NW.MONTHLY?a.plan&&a.plan===I.un.FIVE_X&&(null==d?void 0:d.max5xMonthlyPromoCode)?r=null==d?void 0:d.max5xMonthlyPromoCode:a.plan===I.un.TWENTY_X&&(null==d?void 0:d.max20xMonthlyPromoCode)?r=null==d?void 0:d.max20xMonthlyPromoCode:(null==d?void 0:d.proMonthlyPromoCode)&&(r=d.proMonthlyPromoCode):a.billingInterval===I.NW.YEARLY&&(null==d?void 0:d.proAnnualPromoCode)&&(r=d.proAnnualPromoCode));let u="verified_setup_intent_id"in l&&l.verified_setup_intent_id;return o&&!u?i({...l,company_name:a.companyName,billingInterval:a.billingInterval,promoCode:r,plan:a.plan||"pro"}).catch(()=>{throw e(!1),Error("Failed to create payment verification")}):t({...l,company_name:a.companyName,billingInterval:a.billingInterval,promoCode:r,plan:a.plan},{onError:()=>{e(!1)}})},[a,n,t,i,s,e,d,c,o])};function R(e){let a,{defaultCountry:l,isLoading:i=!1,amount:m,currency:y,setAddress:h,setTaxParams:_,action:g,children:v,className:f,returnPath:x,onCancel:A,onPaymentMethodUpdated:k,legalAccepted:T,...E}=e,S=(0,b.A)(),I=(0,t.ib)(),[C,N]=(0,p.useState)(!0),{theme:M,mode:j}=(0,s.D)(),R=(0,n.l)(),w=(0,t.Ri)("update"===g),B=R.get(u.eT.COLOR_MODE),L={loader:"never",appearance:{theme:"stripe",variables:{fontSizeBase:"16px",colorBackground:(0,o.w)(M,j,B,"bg-000"),colorText:(0,o.w)(M,j,B,"text-100")}},locale:(0,t.bN)(S.locale)},U=!0;return"subscribe"===g?a={mode:"subscription",amount:m,currency:null==y?void 0:y.toLowerCase(),payment_method_types:["card","link"],...L}:(U=!!w,a={clientSecret:null==w?void 0:w.clientSecret,...L}),(0,r.jsxs)("div",{className:(0,c.A)("relative",f),style:{minHeight:"460px"},children:[U&&!i&&(0,r.jsx)("div",{className:(0,c.A)("w-full pt-1 transition-opacity duration-1000",{"opacity-0":C||i}),children:(0,r.jsx)(d.Elements,{options:a,stripe:I,children:(0,r.jsx)(P,{onReady:()=>N(!1),defaultCountry:l,setAddress:h,setTaxParams:_,action:g,returnPath:x,onCancel:A,onPaymentMethodUpdated:k,legalAccepted:T,...E,children:v})})}),(C||i)&&(0,r.jsx)(V,{})]})}let V=()=>(0,r.jsx)("div",{className:"absolute inset-0 flex h-full w-full items-center justify-center",children:(0,r.jsx)(i.Loading,{})})}}]);